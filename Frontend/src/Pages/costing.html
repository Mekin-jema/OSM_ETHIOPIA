<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Isochrone Demo</title>
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <script
      type="text/javascript"
      src="//unpkg.com/maplibre-gl@4.0.2/dist/maplibre-gl.js"
    ></script>
    <script type="text/javascript" src="//unpkg.com/@stadiamaps/api@3"></script>
    <link
      href="//unpkg.com/maplibre-gl@4.0.2/dist/maplibre-gl.css"
      rel="stylesheet"
    />

    <style type="text/css">
      body {
        margin: 0;
        padding: 0;
      }

      #map {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script type="text/javascript">
      function isochrone(lat, lon, costing, callback) {
        const api = new stadiaMapsApi.RoutingApi();

        // Build an isochrone request
        const req = {
          locations: [
            {
              lat: lat,
              lon: lon,
            },
          ],
          costing: costing,
          contours: [
            { time: 5, color: "33cc33" },
            { time: 10, color: "ff9900" },
            { time: 15, color: "cc3300" },
          ],
          polygons: true,
        };

        api
          .isochrone({ isochroneRequest: req })
          .then(callback)
          .catch(function () {
            console.error(e);
          });
      }

      var map = new maplibregl.Map({
        container: "map",
        style: "https://tiles.stadiamaps.com/styles/alidade_smooth.json", // Style URL; see our documentation for more options
        center: [24.73715, 59.43995], // Initial focus coordinate
        zoom: 13,
      });

      // MapLibre GL JS does not handle RTL text by default,
      // so we recommend adding this dependency to fully support RTL rendering if your style includes RTL text
      maplibregl.setRTLTextPlugin(
        "https://unpkg.com/@mapbox/mapbox-gl-rtl-text@0.2.3/mapbox-gl-rtl-text.min.js"
      );

      // Add zoom and rotation controls to the map.
      map.addControl(new maplibregl.NavigationControl());

      // Get pedestrian isochrones from Balti Jaam in Tallinn, Estonia
      isochrone(59.43995, 24.73715, "pedestrian", function (response) {
        map.addLayer({
          id: "isochrone",
          type: "fill",
          source: {
            type: "geojson",
            data: response,
          },
          layout: {},
          paint: {
            "fill-color": ["get", "color"],
            "fill-opacity": ["get", "opacity"],
          },
        });
      });
    </script>
  </body>
</html>
